<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title></title>

<script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>

<script>
    jQuery(document).ready(function($){
        // Parse the URL
        function getParameterByName(name) {
          name = name.replace(/[\[]/, "\[").replace(/[\]]/, "\]");
          var regex = new RegExp("[\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
          return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        // UTM TRACKING
        // Get the URL parameters variable by UTM names
        var source = getParameterByName('utm_source');
        var medium = getParameterByName('utm_medium');
        var campaign = getParameterByName('utm_campaign');
        var content = getParameterByName('utm_content');
        var term = getParameterByName('utm_term');

        // Set UTM function: assumes all hidden fields follow this format : <input name="utm_term" type="hidden">
        var set_utm = function setutm(utm_param, utm_val){
          if (Cookies.get(utm_param+'y') != undefined) {
            //jQuery('input[name="utm_'+utm_param+'"]').val('');
            $('input[name="utm_'+utm_param+'"]').val('');
            console.log('Reset code for cookie time');
            $('input[name="utm_'+utm_param+'"]').val(Cookies.get(utm_param+'y'));
            $('input[id="utm_'+utm_param+'"]').val(Cookies.get(utm_param+'y'));
            console.log('Set input to ' + Cookies.get(utm_param+'y'));
          } else {
              console.log('Using current code / no code set');
            if (utm_val != "" ) {
              console.log('Set the cookie');
              Cookies.set(utm_param+'y', utm_val, {path: '/'});
            };
          };
        }

        // Do the Set UTM function for each UTM
        set_utm('source', source);
        //set_utm('medium', medium);
        set_utm('campaign', campaign);
        //set_utm('content', content);
        //set_utm('term', term);
    });
</script>

</head>
  <body>
      <h1>Landing Page</h1>
      <p>(I'm hosted on Gio's repo)</p><br> <br>
      <!--a id="branch_deep_link" href="https://gvatieri.app.link/dCebib6UfX" class="link">Deep Link</a><br><br-->


        <form action="/next.html" method="get">
	  	    <!-- Hidden UTM Fields -->
     	      <input id="utm_source" name="utm_source" value="">
            <input id="utm_campaign" name="utm_campaign" value="">
     	      <!--input id="utm_medium" name="utm_medium" value="">
     	      <input id="utm_content" name="utm_content" value="">
  	        <input id="utm_term" name="utm_term" value=""-->
            <input type="submit" value="Submit">
         </form>


    </body>
</html>
